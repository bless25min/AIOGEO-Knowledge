name: SEO Optimization & Static Pages Generation

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  seo-optimization:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Generate static redirect pages
      run: |
        # å»ºç«‹éœæ…‹é‡å®šå‘é é¢ç›®éŒ„
        mkdir -p static-pages
        
        # ç”Ÿæˆ about.html
        cat > about.html << 'EOF'
        <!DOCTYPE html>
        <html lang="zh-TW">
        <head>
          <meta charset="UTF-8">
          <title>é—œæ–¼ä½œè€… | AIOGEO çŸ¥è­˜åº«</title>
          <meta name="description" content="å»–å¤©ä½‘ Bless Liao - GEO (ç”Ÿæˆå¼å¼•æ“å„ªåŒ–) å°ˆå®¶ï¼Œå°ˆç²¾AIæœå°‹å„ªåŒ–ç­–ç•¥èˆ‡å…§å®¹æ¶æ§‹è¨­è¨ˆ">
          <meta http-equiv="refresh" content="0; url=https://bless25min.github.io/AIOGEO-Knowledge/#/about">
          <link rel="canonical" href="https://bless25min.github.io/AIOGEO-Knowledge/#/about">
          <script>window.location.href='https://bless25min.github.io/AIOGEO-Knowledge/#/about';</script>
        </head>
        <body>
          <h1>é—œæ–¼ä½œè€… - AIOGEO çŸ¥è­˜åº«</h1>
          <p>æ­£åœ¨é‡å®šå‘åˆ° <a href="https://bless25min.github.io/AIOGEO-Knowledge/#/about">é—œæ–¼ä½œè€…é é¢</a></p>
          <p>å¦‚æœæ²’æœ‰è‡ªå‹•è·³è½‰ï¼Œè«‹é»æ“Šä¸Šæ–¹é€£çµã€‚</p>
        </body>
        </html>
        EOF
        
        # ç”Ÿæˆ contributing.html
        cat > contributing.html << 'EOF'
        <!DOCTYPE html>
        <html lang="zh-TW">
        <head>
          <meta charset="UTF-8">
          <title>åƒèˆ‡è²¢ç» | AIOGEO çŸ¥è­˜åº«</title>
          <meta name="description" content="åŠ å…¥ AIOGEO çŸ¥è­˜åº«å»ºè¨­ï¼Œå…±åŒæ¨å‹• GEO é ˜åŸŸç™¼å±•ã€‚æä¾›è²¢ç»æŒ‡å—èˆ‡æœ€ä½³å¯¦å‹™">
          <meta http-equiv="refresh" content="0; url=https://bless25min.github.io/AIOGEO-Knowledge/#/contributing">
          <link rel="canonical" href="https://bless25min.github.io/AIOGEO-Knowledge/#/contributing">
          <script>window.location.href='https://bless25min.github.io/AIOGEO-Knowledge/#/contributing';</script>
        </head>
        <body>
          <h1>åƒèˆ‡è²¢ç» - AIOGEO çŸ¥è­˜åº«</h1>
          <p>æ­£åœ¨é‡å®šå‘åˆ° <a href="https://bless25min.github.io/AIOGEO-Knowledge/#/contributing">åƒèˆ‡è²¢ç»é é¢</a></p>
          <p>å¦‚æœæ²’æœ‰è‡ªå‹•è·³è½‰ï¼Œè«‹é»æ“Šä¸Šæ–¹é€£çµã€‚</p>
        </body>
        </html>
        EOF
        
        # ç”Ÿæˆä¸»è¦æ–‡ç« é é¢
        cat > geo-fundamentals.html << 'EOF'
        <!DOCTYPE html>
        <html lang="zh-TW">
        <head>
          <meta charset="UTF-8">
          <title>GEOåŸºç¤åŸç†å®Œæ•´æŒ‡å— | AIOGEO çŸ¥è­˜åº«</title>
          <meta name="description" content="æ·±å…¥è§£æ GEO (Generative Engine Optimization) åŸºç¤åŸç†ï¼Œæä¾›AIæœå°‹æ™‚ä»£çš„å…§å®¹å„ªåŒ–ç­–ç•¥èˆ‡å¯¦æˆ°æŠ€å·§">
          <meta http-equiv="refresh" content="0; url=https://bless25min.github.io/AIOGEO-Knowledge/#/posts/geo-fundamentals">
          <link rel="canonical" href="https://bless25min.github.io/AIOGEO-Knowledge/#/posts/geo-fundamentals">
          <script>window.location.href='https://bless25min.github.io/AIOGEO-Knowledge/#/posts/geo-fundamentals';</script>
        </head>
        <body>
          <h1>GEOåŸºç¤åŸç†å®Œæ•´æŒ‡å—</h1>
          <p>æ­£åœ¨é‡å®šå‘åˆ° <a href="https://bless25min.github.io/AIOGEO-Knowledge/#/posts/geo-fundamentals">GEOåŸºç¤åŸç†é é¢</a></p>
          <p>å¦‚æœæ²’æœ‰è‡ªå‹•è·³è½‰ï¼Œè«‹é»æ“Šä¸Šæ–¹é€£çµã€‚</p>
        </body>
        </html>
        EOF
        
    - name: Generate optimized sitemap
      run: |
        cat > sitemap.xml << 'EOF'
        <?xml version="1.0" encoding="UTF-8"?>
        <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
            <!-- ä¸»é é¢ -->
            <url>
                <loc>https://bless25min.github.io/AIOGEO-Knowledge/</loc>
                <lastmod>$(date +%Y-%m-%d)</lastmod>
                <changefreq>weekly</changefreq>
                <priority>1.0</priority>
            </url>
            
            <!-- éœæ…‹é‡å®šå‘é é¢ -->
            <url>
                <loc>https://bless25min.github.io/AIOGEO-Knowledge/about.html</loc>
                <lastmod>$(date +%Y-%m-%d)</lastmod>
                <changefreq>monthly</changefreq>
                <priority>0.8</priority>
            </url>
            <url>
                <loc>https://bless25min.github.io/AIOGEO-Knowledge/contributing.html</loc>
                <lastmod>$(date +%Y-%m-%d)</lastmod>
                <changefreq>monthly</changefreq>
                <priority>0.6</priority>
            </url>
            <url>
                <loc>https://bless25min.github.io/AIOGEO-Knowledge/geo-fundamentals.html</loc>
                <lastmod>$(date +%Y-%m-%d)</lastmod>
                <changefreq>weekly</changefreq>
                <priority>0.95</priority>
            </url>
            
            <!-- Hash URLs for backup indexing -->
            <url>
                <loc>https://bless25min.github.io/AIOGEO-Knowledge/#!/about</loc>
                <lastmod>$(date +%Y-%m-%d)</lastmod>
                <changefreq>monthly</changefreq>
                <priority>0.7</priority>
            </url>
            <url>
                <loc>https://bless25min.github.io/AIOGEO-Knowledge/#!/posts/geo-fundamentals</loc>
                <lastmod>$(date +%Y-%m-%d)</lastmod>
                <changefreq>weekly</changefreq>
                <priority>0.9</priority>
            </url>
        </urlset>
        EOF
        
        # æ›¿æ›æ—¥æœŸè®Šæ•¸
        sed -i "s/\$(date +%Y-%m-%d)/$(date +%Y-%m-%d)/g" sitemap.xml
        
    - name: Generate robots.txt
      run: |
        cat > robots.txt << 'EOF'
        User-agent: *
        Allow: /
        
        # Sitemap location
        Sitemap: https://bless25min.github.io/AIOGEO-Knowledge/sitemap.xml
        
        # Specific AI bot permissions
        User-agent: GPTBot
        Allow: /
        
        User-agent: Claude-Web
        Allow: /
        
        User-agent: PerplexityBot
        Allow: /
        EOF
        
    - name: Commit and push changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add .
        git diff --staged --quiet || git commit -m "ğŸ¤– è‡ªå‹•ç”Ÿæˆ SEO å„ªåŒ–æª”æ¡ˆ - $(date +%Y-%m-%d)"
        git push
